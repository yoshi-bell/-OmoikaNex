# Test Cases (テストケース一覧)

> [!NOTE]
> アプリケーションの品質を担保するためのテスト要件です。
> バックエンド（Pest）、フロントエンド（Vitest）、および E2E テスト（Playwright）の実装基準となります。

## 1. 認証とアカウント (Auth & User Management)

| ID  | テスト機能              | テスト内容 (Test Case)                                                      | 期待挙動 (Expected Behavior)                                                                         |
| :-: | :---------------------- | :-------------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------- |
| 1-1 | **登録 (Register)**     | 正常な値（重複なしメール、8文字以上等のパスワード）で登録処理を実行する     | ユーザー情報が保存され、認証トークンが発行される。自動ログイン状態でホーム画面へ遷移する。           |
| 1-2 |                         | 既に使用されているメールアドレスで登録を試みる                              | `422 Unprocessable Entity` が返却され、Emailフィールド下に「既に登録されています」と表示される。     |
| 1-3 |                         | 不正なフォーマットのパスワード（7文字以下、または英数列のみ）で登録を試みる | `422 Unprocessable Entity` が返却され、パスワード要件エラーが UI に表示される。                      |
| 1-4 | **ログイン (Login)**    | 登録済みの正しいメールアドレス・パスワードで認証処理を実行する              | 認証が成功し、HttpOnly Cookieにトークンが設定されてホーム画面に遷移する。                            |
| 1-5 |                         | 存在しないメールアドレス、または誤ったパスワードでログインを試みる          | `422` などのエラーが返却され、「認証情報が一致しません」等のグローバルエラーメッセージが表示される。 |
| 1-6 | **ログアウト (Logout)** | ログイン状態でヘッダーのログアウト処理を実行する                            | トークンが無効化（Cookieから削除）され、セッションが切断されてログイン画面に遷移する。               |

---

## 2. タイムラインとツイート投稿 (Timeline & Tweets)

| ID  | テスト機能         | テスト内容 (Test Case)                                                                      | 期待挙動 (Expected Behavior)                                                                       |
| :-: | :----------------- | :------------------------------------------------------------------------------------------ | :------------------------------------------------------------------------------------------------- |
| 2-1 | **TL取得 (Home)**  | ホーム画面にアクセスする                                                                    | 全ユーザーの最新ツイートが取得され、作成日時の降順（最新順）に表示される。                         |
| 2-2 | **無限スクロール** | タイムラインを最下部までスクロールする                                                      | Cursor付きのAPIエンドポイントが発火し、次ページのツイート履歴が継ぎ目なく一覧の下に追加される。    |
| 2-3 | **ツイート投稿**   | 正常なテキスト（140文字以内）を入力し、投稿ボタンを押下する                                 | `201 Created` と共に投稿が保存され、画面の再読み込みなしでタイムラインの先頭に新要素が追加される。 |
| 2-4 |                    | 141文字以上のテキストで投稿ボタンを押下する（またはクライアントバリデーションを通過させる） | 送信が阻止されるか、APIから `422` が返却され、入力欄下に文字数オーバーの警告が表示される。         |
| 2-5 | **ツイート削除**   | 自分のツイートに表示されている「削除」ボタンを押下し、確認モーダルで「はい」を選択する      | 対象のツイートが物理削除または論理削除され、タイムラインや詳細画面のUIから即座に消える。           |
| 2-6 |                    | タイムライン上の自分が投稿していないツイートを確認する                                      | 「削除」ボタン自体がUI上にレンダーされていないこと。                                               |

---

## 3. コメント機能 (Replies / Comments)

| ID  | テスト機能           | テスト内容 (Test Case)                                                       | 期待挙動 (Expected Behavior)                                                                               |
| :-: | :------------------- | :--------------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------------- |
| 3-1 | **コメント投稿**     | ツイート詳細画面で、コメント入力欄にテキストを入力し送信する                 | `parent_id` を保持した子ツイートとして保存され、該当ツイートの直下のコメント一覧の先頭に即座に追加される。 |
| 3-2 | **コメント一覧**     | 他のユーザーがコメント済みのツイート詳細画面にアクセスする                   | 対象の元ツイートが上部に表示され、その下に紐づくコメント群が古い順または指定のソート順で表示される。       |
| 3-3 | **ネストされた操作** | 他のユーザーの「コメント」に対して、さらにコメント（またはいいね）を実行する | 自己参照構造が正しく機能し、コメントに対する「いいね」や「返信」が標準ツイートと同様に行えること。         |

---

## 4. エンゲージメント (Follows & Likes)

| ID  | テスト機能             | テスト内容 (Test Case)                                                           | 期待挙動 (Expected Behavior)                                                                                          |
| :-: | :--------------------- | :------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------------------------------- |
| 4-1 | **いいね (Like)**      | タイムライン上で未いいね状態のツイートの「いいね（ハート）」ボタンをクリックする | **[楽観的UI更新]** API完了を待たずにUIのハートが赤く点灯し、カウントが瞬時に+1される。その後APIで登録処理が成功する。 |
| 4-2 |                        | 既に「いいね」済みのツイートのボタンを再度クリックする                           | **[楽観的UI更新]** 瞬時にハートがグレーになり、カウントが-1される。対象の Like レコードが削除される。                 |
| 4-3 | **エラーロールバック** | オフライン・または意図的にAPIを失敗させる状態で「いいね」をクリックする          | UIが一旦点灯した後、エラーを検知して瞬時に元の状態に戻り、「通信に失敗しました」等のトースト通知が出る。              |
| 4-4 | **フォロー (Follow)**  | 特定ユーザーのプロフィール画面を開き、「フォロー」ボタンを押下する               | レコードが保存され、ボタンのテキストが「フォロー中」といったスタイルに即座に切り替わる。                              |
| 4-5 |                        | 既にフォロー中のユーザーのプロフィール画面を開き、「フォロー中」ボタンを押下する | アンフォロー処理が走り、ボタンが「フォローする」の状態に戻る。                                                        |
| 4-6 | **フォローTL取得**     | 「フォロー中」タブ（タイムライン）をクリックする                                 | 自分がフォローしているアカウントの作成したツイート（およびコメント）のみが抽出され、降順で表示される。                |
